<div #qpPageTop></div>
<div class="container-fluid">

    <div class="content-header">
        <div class="header-icon" >
            <i class="material-icons-outlined">supervisor_account</i>
        </div>
        <div class="header-title">
            <h1>Add / Edit Quarantine Person <span class="sinhalaTitle">(නිරෝධායනයේ නිරත පුද්ගලයින් එක්කිරීම /
                    සංස්කරණය)</span></h1>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <form [formGroup]="form" *ngIf="form">


                <div class="panel panel-bd">
                    <div class="panel-body" style="background-color:lightgreen;">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="page_input set-inline">
                                    <label>
                                        Name (නම)
                                    </label>
                                    <input type="text" formControlName="qp_name">
                                    <div class="err_lo"
                                        *ngIf="submitted && form.controls['qp_name'].hasError('required')">
                                        Name is
                                        required </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="page_input set-inline" >
                                    <label>
                                        NIC (ජා.හැ.අ)
                                    </label>
                                    <input type="text" formControlName="qp_nic">
                                    <div class="err_lo"
                                        *ngIf="submitted && form.controls['qp_nic'].hasError('pattern')">
                                        NIC No. is
                                        not valid </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="page_input set-inline" >
                                    <label>
                                        Passport NO (විදේශ ගමන් බලපත් අංකය)
                                    </label>
                                    <input type="text" formControlName="qp_passportNo">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="page_input set-inline">
                                    <label>
                                        File No (පොලිස් ස්ථානයේ ලේ.අ)
                                    </label>
                                    <input type="text" formControlName="qp_fileNo">
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-3">
                                <div class="page_input set-inline" >
                                    <label>
                                        Province (පළාත)
                                    </label>
                                    <select formControlName="qp_division" (change)="divisionSelected()">
                                        <option *ngFor="let division of divisions" [value]="division">{{division}}
                                        </option>
                                    </select>
                                    <!-- <label class="err_lo">
                                Please fill this field
                            </label> -->
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="page_input set-inline" >
                                    <label>
                                        District (දිස්ත්‍රික්කය)
                                    </label>
                                    <select formControlName="qp_division" (change)="divisionSelected()">
                                        <option *ngFor="let division of divisions" [value]="division">{{division}}
                                        </option>
                                    </select>
                                    <!-- <label class="err_lo">
                                Please fill this field
                            </label> -->
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="page_input set-inline" >
                                    <label>
                                        DS Division (පොලිස් ස්ථානය)
                                    </label>
                                    <select formControlName="qp_policeStationId"
                                        (change)="policeStationSelected($event)">
                                        <option *ngFor="let policeStation of policeStations" [value]="policeStation.id">
                                            {{policeStation.name}}</option>
                                    </select>
                                    <div class="err_lo"
                                        *ngIf="submitted && (form.controls['qp_policeStationId'].hasError('required')||form.controls['qp_policeStationId'].hasError('min'))">
                                        Police Station is
                                        required </div>
                                    <!-- <label class="err_lo">
                                Please fill this field
                            </label> -->
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="page_input set-inline" >
                                    <label>
                                        GN Division (ග්‍රාම නිලධාරී වසම)
                                    </label>
                                    <select formControlName="qp_gramaSewaDivisionId"
                                        (change)="gramaSewaDivisionSelected()">
                                        <option value="0">-- Please Select --</option>
                                        <option *ngFor="let gramaSewaDivision of gramaSewaDivisions"
                                            [value]="gramaSewaDivision.id">{{gramaSewaDivision.name}}</option>
                                    </select>
                                    <div class="err_lo"
                                        *ngIf="submitted && (form.controls['qp_gramaSewaDivisionId'].hasError('required')||form.controls['qp_gramaSewaDivisionId'].hasError('min'))">
                                        Village Offficer Division is
                                        required </div>
                                    <label class="err_lo" *ngIf="errGramaSewaDivision">
                                        Please select valid Division
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="page_input">

                                <app-address-search-map [address]="address"
                                    (address_out)="onChangeSearchAddress(address)" [station]="currentStationName">
                                </app-address-search-map>


                                <div class="err_lo"
                                    *ngIf="submitted && form.controls['qp_address'].hasError('required')">Address is
                                    required </div>
                            </div>
                        </div>

                        <div class="res" style="margin-top: -370px; z-index: 300; position: absolute;">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="page_input">
                                        <label>
                                            Age (වයස)
                                        </label>
                                        <input type="number" formControlName="qp_age">
                                        <div class="err_lo"
                                            *ngIf="submitted && form.controls['qp_age'].hasError('required')">
                                            Age is
                                            required </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="page_input">
                                        <label>
                                            Date Reported (වාර්ථාවු දිනය)
                                        </label>
                                        <input type="date" formControlName="qp_reportedDate">
                                        <div class="err_lo"
                                            *ngIf="submitted && form.controls['qp_reportedDate'].hasError('required')">
                                            Date
                                            is
                                            required </div>
                                    </div>
                                </div>

                            </div>

                            <div class="row">
                                <div class="col-md-3">
                                    <div class="page_input">
                                        <label>
                                            Mobile Number (ජංගම දුරකතන අංකය) - 07XXXXXXX
                                        </label>
                                        <input type="text" formControlName="qp_mobile" (keypress)="fillMobileNo()"
                                            title="0 න් පටන් ගන්නා හා අංක 10 කින් යුතු විය යුතුය. උදා: 07XXXXXXX">
                                        <div class="err_lo"
                                            *ngIf="submitted && form.controls['qp_mobile'].hasError('pattern')">
                                            Mobile No. is
                                            not valid </div>
                                        <div class="err_lo" *ngIf="appEnabledValidation">
                                            Mobile No. is
                                            required
                                        </div>
                                    </div>

                                    <div class="err_lo"
                                        *ngIf="submitted && form.controls['qp_mobile'].hasError('required')">
                                        Mobile No. is
                                        required </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="page_input">
                                        <label>
                                            Land Line (ස්ථාවර දුරකතන අංකය)
                                        </label>
                                        <input type="text" formControlName="qp_phone">
                                        <div class="err_lo"
                                            *ngIf="submitted && form.controls['qp_phone'].hasError('pattern')">
                                            Land Line No. is
                                            not valid </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="checkbox">
                                        <label><input type="checkbox" formControlName="qp_appEnable">දුරකතන
                                            යෙදුමක් භාවිතා කිරීමේ හැකියාවක්
                                            ඇත්ද?</label>
                                    </div>
                                </div>
                            </div>

                            <br />

                            <p><b>විදේශ රටක සිට පැමිණියේ නම්</b></p>

                            <div class="row">
                                <div class="col-md-3">
                                    <div class="page_input">
                                        <label>
                                            Date (පැමිණි දිනය)
                                        </label>
                                        <input type="date" formControlName="qp_arrivalDate">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="page_input">
                                        <label>
                                            Country (පැමිණි රට)
                                        </label>
                                        <select formControlName="qp_countryId" (change)="counrtySelected()">
                                            <option *ngFor="let country of countries" [value]="country.id">
                                                {{country.name}}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel panel-bd">
                    <div class="panel-body" style="background-color:lightblue;">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="row">
                                    <div class="col-md-2">
                                        <div class="page_input">
                                            <select (change)="changeStatus($event)">
                                                <option value="1">Home(නිවසෙදී)</option>
                                                <option value="2">Remorte(නිරෝධනය මධ්යස්ථාන)</option>
                                                <option value="3">Positive COVID-19(තහවුරුකරනලද)</option>
                                                <option value="4">Suspect COVID-19(සැක සහිත)</option>
                                            </select>
                                            <div class="err_lo"
                                                *ngIf="submitted && (form.controls['qp_policeStationId'].hasError('required')||form.controls['qp_policeStationId'].hasError('min'))">
                                                Police Station is
                                                required </div>
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="page_input set-inline" >
                                            <label>
                                                Start Date (ආරම්භකල දිනය)
                                            </label>
                                            <input type="date" formControlName="qp_reportedDate">
                                            <div class="err_lo"
                                                *ngIf="submitted && form.controls['qp_reportedDate'].hasError('required')">
                                                Date
                                                is
                                                required
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="page_input set-inline" >
                                            <label>
                                                End Date (නිමවන දිනය)
                                            </label>
                                            <input type="date" formControlName="qp_reportedDate">
                                            <div class="err_lo"
                                                *ngIf="submitted && form.controls['qp_reportedDate'].hasError('required')">
                                                Date
                                                is
                                                required
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3" *ngIf="status == 3 || status == 4">
                                        <div class="page_input set-inline" >
                                            <label>
                                                Hospital (රෝහල)
                                            </label>
                                            <div class="ng-autocomplete auto_width">
                                                <ng-autocomplete [data]="hospitals" [searchKeyword]="keyword"
                                                    placeHolder="Enter Hospital Name" (selected)='selectEventAd($event)'
                                                    (inputChanged)='onChangeSearchAd($event)'
                                                    (inputFocused)='onFocusedAd($event)' historyIdentifier="hospital"
                                                    [itemTemplate]="itemTemplate" [notFoundTemplate]="notFoundTemplate">
                                                </ng-autocomplete>

                                                <ng-template #itemTemplate let-item>
                                                    <a [innerHTML]="item.name"></a>
                                                </ng-template>

                                                <ng-template #notFoundTemplate let-notFound>
                                                    <div [innerHTML]="notFound"></div>
                                                </ng-template>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3" *ngIf="status == 2">
                                        <div class="page_input set-inline" >
                                            <label>
                                                Center (මධ්යස්ථානය)
                                            </label>
                                            <input type="text" formControlName="qp_phone">
                                            <div class="err_lo"
                                                *ngIf="submitted && form.controls['qp_phone'].hasError('pattern')">
                                                Land Line No. is
                                                not valid </div>
                                        </div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="page_input set-inline" >
                                            <label>
                                                <span>&#8203;</span>
                                            </label>
                                            <div class="input_button">
                                                <button>Add</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <div>

                        </div>
                        <div class="row">
                            <div class="page_table page_table_list" style="margin: 0px 12px 0px 12px;">
                                <div class="table-responsive">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <!-- <th>ID</th> -->
                                                <th>Record Catogory</th>
                                                <th>Start / Admit /Informed Date</th>
                                                <th>End / Discharge Date</th>
                                                <th>Center</th>
                                                <th>Hospital</th>
                                                <th>Case No</th>
                                                <th>Other Information</th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Home</td>
                                                <td>2020/04/01</td>
                                                <td>2020/4/15</td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td>No other information</td>
                                            </tr>
                                            <tr>
                                                <td>Remorte</td>
                                                <td>2020/04/02</td>
                                                <td>2020/4/16</td>
                                                <td>Punani</td>
                                                <td></td>
                                                <td></td>
                                                <td>Contact round one</td>
                                            </tr>
                                            <tr>
                                                <td>Positive Record</td>
                                                <td>2020/04/10</td>
                                                <td></td>
                                                <td></td>
                                                <td>Kalubowila</td>
                                                <td>15</td>
                                                <td>Direct contact</td>
                                            </tr>
                                        </tbody>

                                    </table>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>

        </div>
        <div class="footer">
            <!-- <div class="panel panel-bd" style="margin: 0 48px 0 16px;">
                <div class="panel-body"> -->
            <div class="row">
                <div class="pull-right">
                    <div class="page_button pageptn">
                        <button type="submit" (click)="resetForm()">Clear</button>
                        <button type="submit" (click)="addNewPerson();scroll(qpPageTop)"
                            *ngIf="saveButtonFlag">Save</button>
                        <button type="submit" (click)="addNewPerson(true)">Save & Exit</button>
                        <button type="submit" [routerLink]="['/quarantine/quarantine-person']">Cancel</button>
                    </div>
                </div>
            </div>
            <!-- </div>
            </div> -->
        </div>
    </div>
</div>

<!-- <div id="new_person" class="overlay">
    <div class="popup" style="width: 90%;">
        <div class="popup_heading ">
            <div class="row margin ">
                <div class="pull-right ">
                    <a class="close " (click)="close_add_new()">&times;</a>
                </div>
                <h2>Add New Officer</h2>
            </div>
        </div>
        <div class="content">
            <div *ngIf="new_person">
            <app-add-edit-person [id]="q_person_id" (pageRefersh)="onPageRefresh($event)">
                </app-add-edit-person>
             </div>
        </div>
    </div>
</div> -->

<!-- Modal -->
<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content popup">
            <!-- <div class="modal-header"> -->
            <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
            <!-- <h4 class="modal-title">Modal Header</h4> -->
            <div class="popup_heading ">
                <div class="row margin ">
                    <div class="pull-right ">
                        <a class="close " data-dismiss="modal">&times;</a>
                    </div>
                    <h2>Add New Officer</h2>
                </div>
                <!-- </div> -->
            </div>
            <div class="modal-body" *ngIf="new_officer">
                <app-new-officer (save)="close_add_new($event)"></app-new-officer>
            </div>
            <!-- <div class="modal-footer page_button pageptn">
                <button data-dismiss="modal">Close</button>
                <button (click)="add_new()">Save</button>
            </div> -->
        </div>

    </div>
</div>